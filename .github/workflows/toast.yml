name: toast

on:
  workflow_dispatch:
    inputs:
      url:
        description: the url you want to track
      repo:
        description: the repo that save the archive

jobs:
  scrape:
    runs-on: ubuntu-latest
    steps:
      - name: Install httrack
        run: sudo apt-get install -y httrack
      - uses: actions/checkout@v4
      - uses: actions/checkout@v4
        with:
          repository: ${{inputs.repo}}
          path: website
      - uses: robinraju/release-downloader@v1.8
        continue-on-error: true
        with:
          repository: ${{inputs.repo}}
          latest: true
          fileName: cache-part*
          tarBall: false
          zipBall: false
          extract: false
          token: ${{ secrets.TOAST_TOKEN }}
      - run: ls
      - run: sh toast/copy.sh ${{ inputs.url }}
      - uses: ncipollo/release-action@v1
        with:
          artifacts: dist/cache-parts*
          token: ${{ secrets.TOAST_TOKEN }}
          repo: ${{inputs.repo}}
          tag: cache
          allowUpdates: true
          
